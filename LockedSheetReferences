'Useful algorthms for locked sheet, to allow sorting, filtering, grouping etc

'unprotect the sheet
Sheets("Main").Unprotect "password"

'check if the sheet has edit ranges (to allow sorting through cell lock)
If Sheets("Main").Protection.AllowEditRanges.Count <> 0 Then
    For i = 1 To Sheets("Main").Protection.AllowEditRanges.Count
        ActiveSheet.Protection.AllowEditRanges(i).Delete
    Next i
End If

'add allowed edit range to allow users to sort sheet
Sheets("Main").Protection.AllowEditRanges.Add Title:="AllowSort", Range:=Range(Cells(lDataRow_Main + 1, 1), Cells(lLRow_Main, lLCol_Main))
'reference : https://stackoverflow.com/questions/10197772/how-to-lock-specific-cells-but-allow-filtering-and-sorting/15390698#15390698

'password protect the sheet
Sheets("Main").Protect Password:="password", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True, UserInterfaceOnly:=True, _
    AllowFormattingColumns:=True, AllowFormattingRows:=True
    
'enable grouping
Sheets("Main").EnableOutlining = True

'disable selecting locked cells
Sheets("Main").EnableSelection = xlUnlockedCells
